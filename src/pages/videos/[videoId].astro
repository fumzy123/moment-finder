---
// Exract the video name from the URL Path parameters
const { videoId } = Astro.params;
console.log('Video name from params:', videoId);

// Construct the API URL to fetch video details
const apiURL = new URL(`/api/videos/${videoId}`, Astro.url);
console.log('Fetching video details from:', apiURL.href);

// Layout
import Layout from '../../presentation/layouts/Layout.astro';

// Components
import VideoAnnotationCanvas from '../../presentation/feature/VideoAnnotationCanvas.tsx';
import type { GetUploadedVideoResponse } from '../api/videos/dtos/GetUploadedVideoResponse';
import QueryProvider from '../../provider/QueryProvider';
import ScreenshotDisplay from '../../presentation/feature/ScreenshotDisplay';
import VideoAnnotationPage from '../../presentation/layouts/VideoAnnotationPage';

// Make a GET request to the API Route to retrieve the video details
let response = await fetch(apiURL);
const { data, error, message } =
    (await response.json()) as GetUploadedVideoResponse;

const video = {
    width: 1200,
    controls: true,
    ...data,
};
---

<Layout>
    <VideoAnnotationPage client:only="react" video={video} />
</Layout>
